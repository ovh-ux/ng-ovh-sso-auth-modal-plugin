/*! ovh-angular-sso-auth-modal-plugin - 1.0.14 - 2017-07-04 */
angular.module("ovh-angular-sso-auth-modal-plugin",["pascalprecht.translate","ui.bootstrap","ovh-angular-sso-auth"]),angular.module("ovh-angular-sso-auth-modal-plugin").controller("SsoAuthModalController",["$q","$window","$translatePartialLoader","$translate","params",function(a,b,c,d,e){"use strict";function f(){var b=a.defer();return $.ajax(h.data.userConfig).done(function(a){b.resolve(a)}).fail(function(a){b.resolve(a)}),b.promise}function g(){return c.addPart(h.data.translationPath),d.refresh().then(function(){return h.loaders.trads=!1,"DISCONNECTED_TO_CONNECTED"===h.data.mode||"CONNECTED_TO_OTHER"===h.data.mode?f().then(function(a){h.data.currentUser=a},function(){h.reload()}):void 0})["finally"](function(){h.loaders.init=!1})}var h=this;h.loaders={trads:!0,init:!0,action:!1},h.data=e,h.reload=function(){h.loaders.action=!0,b.location.replace(b.location.href.replace(b.location.hash,""))},h.logout=function(){h.loaders.action=!0,b.location.replace(h.data.logoutUrl)},g()}]),angular.module("ovh-angular-sso-auth-modal-plugin").config(["$provide",function(a){"use strict";a.decorator("ssoAuthentication",["$delegate","ssoAuthModalPluginFct",function(a,b){return a.handleSwitchSession=function(){return b.handleSwitchSession(a)},a}])}]),angular.module("ovh-angular-sso-auth-modal-plugin").provider("ssoAuthModalPluginFct",function(){"use strict";var a,b="../bower_components/ovh-angular-sso-auth-modal-plugin/dist/modal";this.setTranslationsPath=function(a){b=a},this.$get=["$injector",function(c){return{handleSwitchSession:function(d){if(!a){var e=c.get("$q"),f=c.get(c.has("$uibModal")?"$uibModal":"$modal");a=e.defer();var g=d.getUserIdCookie(),h={userId:d.userId,user:d.user,userConfig:{url:d.getUserUrl(),method:"GET",headers:d.getHeaders()},logoutUrl:d.getLogoutUrl(),translationPath:b};d.userId&&!g?h.mode="CONNECTED_TO_DISCONNECTED":!d.userId&&g?h.mode="DISCONNECTED_TO_CONNECTED":d.userId!==g&&(h.mode="CONNECTED_TO_OTHER"),f.open({templateUrl:"src/modal/sso-auth-modal-plugin.html",controller:"SsoAuthModalController",controllerAs:"ssoAuthModalCtrl",resolve:{params:function(){return angular.copy(h)}},size:"DISCONNECTED_TO_CONNECTED"===h.mode||"CONNECTED_TO_OTHER"===h.mode?"lg":void 0,keyboard:!1,backdrop:"static"})}return a.promise}}}]}),angular.module("ovh-angular-sso-auth-modal-plugin").run(["$templateCache",function(a){"use strict";a.put("src/modal/ovh-angular-sso-auth-modal-plugin.html","<div id=sso-modal><div class=modal-header data-ng-if=!ssoAuthModalCtrl.loaders.trads><h3 class=modal-title><span class=\"glyphicon glyphicon-lock\" aria-hidden=true></span> <span data-translate=sso_modal_title></span></h3></div><div class=modal-body data-ng-if=ssoAuthModalCtrl.loaders.init data-translate=sso_modal_loading></div><div class=modal-body data-ng-if=!ssoAuthModalCtrl.loaders.init><div class=row><div data-ng-if=\"ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_DISCONNECTED' || ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_OTHER'\" data-ng-class=\"{'col-md-12 span12': ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_DISCONNECTED', 'col-md-6 span6': ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_OTHER' }\"><p data-translate=sso_modal_user_title></p><div class=\"panel panel-default\" data-ng-class=\"{'panel-disabled': ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_OTHER'}\"><div class=panel-body><div class=sso-modal-account-badge-ctnr><div class=sso-modal-account-badge aria-hidden=true><span class=\"glyphicon glyphicon-user\"></span></div></div><div class=sso-modal-account-infos-ctnr><div class=sso-modal-account-infos><strong data-ng-bind=\"ssoAuthModalCtrl.data.user.firstname + ' ' + ssoAuthModalCtrl.data.user.name\"></strong><br><span data-ng-bind=ssoAuthModalCtrl.data.user.email></span><br><span data-ng-bind=ssoAuthModalCtrl.data.user.nichandle></span></div></div></div></div></div><div data-ng-if=\"ssoAuthModalCtrl.data.mode === 'DISCONNECTED_TO_CONNECTED' || ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_OTHER'\" data-ng-class=\"{'col-md-12 span12': ssoAuthModalCtrl.data.mode === 'DISCONNECTED_TO_CONNECTED', 'col-md-6 span6': ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_OTHER' }\"><p data-ng-class=\"{'bold': ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_OTHER'}\" data-translate=sso_modal_currentuser_title></p><div class=\"panel panel-default\"><div class=panel-body><div class=sso-modal-account-badge-ctnr><div class=sso-modal-account-badge aria-hidden=true><span class=\"glyphicon glyphicon-user\"></span></div></div><div class=sso-modal-account-infos-ctnr><div class=sso-modal-account-infos><strong data-ng-bind=\"ssoAuthModalCtrl.data.currentUser.firstname + ' ' + ssoAuthModalCtrl.data.currentUser.name\"></strong><br><span data-ng-bind=ssoAuthModalCtrl.data.currentUser.email></span><br><span data-ng-bind=ssoAuthModalCtrl.data.currentUser.nichandle></span></div></div></div></div></div></div><p data-ng-if=\"ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_DISCONNECTED'\" class=bold data-translate=sso_modal_disconnected></p><p data-ng-if=\"ssoAuthModalCtrl.data.mode === 'DISCONNECTED_TO_CONNECTED' || ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_OTHER'\" class=bold data-translate=sso_modal_what></p></div><div class=\"modal-footer clearfix\" data-ng-if=!ssoAuthModalCtrl.loaders.init><div data-ng-if=\"ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_DISCONNECTED'\"><button type=button class=\"btn btn-primary pull-right\" autofocus data-ng-click=ssoAuthModalCtrl.logout() data-ng-disabled=ssoAuthModalCtrl.loaders.action data-translate=sso_modal_action_logout></button></div><div data-ng-if=\"ssoAuthModalCtrl.data.mode === 'DISCONNECTED_TO_CONNECTED' || ssoAuthModalCtrl.data.mode === 'CONNECTED_TO_OTHER'\"><button type=button class=\"btn btn-primary pull-right\" autofocus data-ng-click=ssoAuthModalCtrl.reload() data-ng-disabled=ssoAuthModalCtrl.loaders.action data-translate=sso_modal_action_reload data-translate-values=\"{ name: ssoAuthModalCtrl.data.currentUser.firstname + ' ' + ssoAuthModalCtrl.data.currentUser.name }\"></button> <button type=button class=\"btn btn-default pull-left\" data-ng-click=ssoAuthModalCtrl.logout() data-ng-disabled=ssoAuthModalCtrl.loaders.action data-translate=sso_modal_action_logout></button></div></div></div>")}]);